# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

parameters:
  - name: targetRegion
    displayName: Target Azure Region for deployment
    type: string
    default: canadacentral
    values:
      - canadacentral
      - canadaeast

  - name: targetContainer
    displayName: Target Host Container
    type: string
    values:
      - blue
      - green

  - name: podId
    displayName: Pod ID (format:POD##, ex POD01)
    type: string
    default: POD01

pool:
  name: Hosted Windows 2019 with VS2019
  demands: azureps

stages:
  - template: pipeline/prep-stage.yml
    parameters:
      azureSubscription: ""
      storageAccountName: ""
  - template: pipeline/deploy-pod-stage.yml

  - template: pipeline/deploy-host-group-stage.yml

  - template: pipeline/swap-users-stage.yml

  - template: pipeline/destroy-host-group-stage.yml
